{"compress":true,"commitItems":[["6ee11eab-2083-448e-89a0-d90c3cbfc44f",1630380844254,"---\nlayout: 《开源项目篇》-- Swoole-webcoket 小型公共聊天系统\ntitle:   《开源项目篇》-- Swoole-webcoket 小型公共聊天系统\ndate:  2020-01-02 15:23:54\ncategories: \"开源项目\"\nabbrlink: 061b\ntags: \n- PHP\n- Laravel\n- 开源项目\n- Github\n- Swoole\n- Websocket\n---\n\n<img src=\"https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/caa7c7a6a9206432df2918c036ff593b.jpg\" style=\"width:900px;height:400px\" />\n\n# 导言\n该项目是小编在学习`Swoole`而衍生的一个项目，在接触了`Swolle` 的 `Websocket`之后，利用其相关知识点构建了这么一个即时通讯聊天系统，目前该系统只支持在一个群聊公共聊天，前端支持QQ，微博，GIthub, google快速登录，也可以使用邮箱注册登录，暂未支持好友聊天，群组聊天等场景。\n\n<!--less-->\n\n## 项目部署\n\n由于该项目是基于`Laravel 5.6`, `Swoole` 开发的，首先你得确保你服务器符合以下要求：\n\n*   PHP >= 7.1.3\n*   OpenSSL PHP扩展\n*   PDO PHP扩展，注意需要php_mysql\n*   Mbstring PHP扩展\n*   Tokenizer PHP扩展\n*   XML PHP扩展\n*   Swoole PHP扩展\n\n项目地址：\n\n> [https://github.com/linyiyuan/swoole-webchat.git](https://github.com/linyiyuan/swoole-webchat.git)\n\n项目演示地址：\n\n> [http://webchat.linyiyuan.top](http://webchat.linyiyuan.top/)\n\n**第1步：克隆代码**\n\n```bash\ngit clone https://github.com/linyiyuan/picture_bed.git\n```\n\n\n**第2步：安装composer包**\n\n```bash\ncomposer install\n```\n\n\n**第3步：配置文件**\n\n1、在项目中找到`.env.example`文件，该文件作为项目的全局配置文件，在部署时需要复制成`.env`，执行以下命令\n\n```bash\ncp -f .env.example ./.env\n```\n\n打开配置文件，可以看到如下的部分配置：\n\n```bash\nSERVER_URL=当前服务器IP地址（如果是云服务器请填内网地址）\nSERVER_PORT=启动服务的端口（一般填9501即可）\nSERVER_ADMIN_PORT=启动服务的内网端口（可忽略不填）\n```\n\n\n紧接着我们打开`public/dist/js/example.js` 并修改：\n\n```bash\nws = new WebSocket(\"ws://服务器地址:Websocket服务端口\");//连接服务器\n```\n\n需要注意的是服务器地址如果有域名解析则需要填写域名，这是由于`cookie`可能会导致数据不同步\n配置完上面还需配置一下第三方登录的一些参数：\n\n```bash\n//GITHUB授权登录秘钥\nGITHUB_CLIENT_ID=\nGITHUB_CLIENT_SECRET=\nGITHUB_REDIRECT=http://webchat.linyiyuan.top/OAuth/callback/github\n\n//微博授权登录秘钥\nWEIBO_KEY=\nWEIBO_SECRET=\nWEIBO_REDIRECT_URI=http://webchat.linyiyuan.top/OAuth/callback/weibo\n\n//QQ授权登录秘钥\nQQ_APP_ID=\nQQ_APP_KEY=\nQQ_REDIRECT=http://webchat.linyiyuan.top/OAuth/callback/qq\n\n//谷歌授权登录秘钥\nGOOGLE_APP_ID=\nGOOGLE_APP_KEY=\nGOOGLE_REDIRECT=http://webchat.linyiyuan.top/OAuth/callback/google\n```\n\n2、根据.env文件修改各配置项，如果.env文件中没有存在key值则运行命令：\n\n```bash\nphp artisan key:generate\n```\n\n3、配置stroage bootstrap 可写\n\n```bash\nchmod -R 777 stroage bootstrap\n```\n\n\n**第4步：启动服务**\n\n在项目目录下运行一下命令\n\n```bash\nphp artisan server:build Websocket\n```\n\n\n控制台显示`The WebSocket Server is Started` 说明启动成功，由于该命令需要后台常驻，我们可以使用`supervisor` 来进行管理，至此项目部署已经基本以完成，配置相应apache或者nginx 域名指向即可访问网站\n\n## 项目展示\n\n[![登录页面](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/b71f4a907186bb9915934c4522a4100e.jpg)](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/b71f4a907186bb9915934c4522a4100e.jpg \"登录页面\")\n\n[![注册页面](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/d765f586b988b4014dfb806b705edf8d.jpg)](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/d765f586b988b4014dfb806b705edf8d.jpg \"注册页面\")\n\n[![加入聊天室](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/17543dfced3ed6474b6879ec29eb590b.jpg)](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/17543dfced3ed6474b6879ec29eb590b.jpg \"加入聊天室\")\n\n[![多人聊天](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/0c2efe0685655d9a1809cb07c6031d93.jpg)](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/0c2efe0685655d9a1809cb07c6031d93.jpg \"多人聊天\")\n\n[![夜晚模式](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/caa7c7a6a9206432df2918c036ff593b.jpg)](https://shmily-album.oss-cn-shenzhen.aliyuncs.com/photo_album_14/caa7c7a6a9206432df2918c036ff593b.jpg \"夜晚模式\")\n",[[1630380843521,["Administrator@YMS-20200313EGD",[[-1,148,"61"]],[150,150],[148,148]]],[1630380844050,["Administrator@YMS-20200313EGD",[[1,148,"19"]],[148,148],[150,150]]]],null,"Administrator@YMS-20200313EGD"]]}